<testset xmlns="http://cpee.org/ns/properties/2.0">
    <executionhandler>ruby</executionhandler>
    <dataelements>
        <idStart>start-mixer</idStart>
        <mixerSignaled>true</mixerSignaled>
        <idStop>stop-mixer</idStop>
        <mixerIntensity>2</mixerIntensity>
        <mixingTime>10</mixingTime>
    </dataelements>
    <endpoints>
        <user>https-post://cpee.org/services/timeout-user.php</user>
        <auto>https-post://cpee.org/services/timeout-auto.php</auto>
        <subprocess>https-post://cpee.org/flow/start/url/</subprocess>
        <timeout>https://cpee.org/services/timeout.php</timeout>
        <send>https-post://cpee.org/ing/correlators/message/send/</send>
        <receive>https-get://cpee.org/ing/correlators/message/receive/</receive>
        <globaltolocal>https://lab.bpm.in.tum.de/ur/programs/Youssef/GlobalToLocal.urp/wait</globaltolocal>
        <localpickupmixer>https://lab.bpm.in.tum.de/ur/programs/Youssef/LocalPickupMixer.urp/wait</localpickupmixer>
        <mixerpickuplocal>https://lab.bpm.in.tum.de/ur/programs/Youssef/MixerPickuptLocal.urp/wait</mixerpickuplocal>
        <localtoglobal>https://lab.bpm.in.tum.de/ur/programs/Youssef/LocalToGlobal.urp/wait</localtoglobal>
    </endpoints>
    <attributes>
        <info>mixer-control</info>
        <modeltype>CPEE</modeltype>
        <theme>extended</theme>
    </attributes>
    <description>
        <description xmlns="http://cpee.org/ns/description/1.0">
            <loop mode="pre_test" condition="true">
                <_probability>
                    <_probability_min/>
                    <_probability_max/>
                    <_probability_avg/>
                </_probability>
                <call id="a7" endpoint="subprocess">
                    <parameters>
                        <label>Set Intensity For Mixer</label>
                        <arguments>
                            <behavior>wait_running</behavior>
                            <url>https://raw.githubusercontent.com/ylkhayat/universal-robots-mixing/main/intensity-process.xml</url>
                            <init>
                                <mixerintensity>!data.mixerIntensity</mixerintensity>
                            </init>
                            <endpoints/>
                            <attributes/>
                            <customization/>
                        </arguments>
                    </parameters>
                    <annotations>
                        <_generic/>
                        <_timing>
                            <_timing_weight/>
                            <_timing_avg/>
                            <explanations/>
                        </_timing>
                        <_shifting>
                            <_shifting_type>Duration</_shifting_type>
                        </_shifting>
                        <_context_data_analysis>
                            <probes/>
                            <ips/>
                        </_context_data_analysis>
                        <report>
                            <url/>
                        </report>
                        <_notes>
                            <_notes_general/>
                        </_notes>
                    </annotations>
                    <documentation>
                        <input/>
                        <output/>
                        <implementation>
                            <description/>
                        </implementation>
                    </documentation>
                </call>
                <parallel wait="-1" cancel="last">
                    <parallel_branch pass="" local="">
                        <manipulate id="a1" label="">data.mixerSignaled = false</manipulate>
                        <loop mode="pre_test" condition="!data.mixerSignaled">
                            <_probability>
                                <_probability_min/>
                                <_probability_max/>
                                <_probability_avg/>
                            </_probability>
                            <call id="a10" endpoint="receive">
                                <parameters>
                                    <label>Signal Mixer Start</label>
                                    <arguments>
                                        <id>!data.idStart</id>
                                        <ttl>0</ttl>
                                        <delete>true</delete>
                                    </arguments>
                                </parameters>
                                <code>
                                    <prepare/>
                                    <finalize output="result">data.mixerSignaled = true</finalize>
                                    <update output="result"/>
                                    <rescue output="result">data.mixerSignaled = false</rescue>
                                </code>
                                <annotations>
                                    <_generic/>
                                    <_timing>
                                        <_timing_weight/>
                                        <_timing_avg/>
                                        <explanations/>
                                    </_timing>
                                    <_shifting>
                                        <_shifting_type>Duration</_shifting_type>
                                    </_shifting>
                                    <_context_data_analysis>
                                        <probes/>
                                        <ips/>
                                    </_context_data_analysis>
                                    <report>
                                        <url/>
                                    </report>
                                    <_notes>
                                        <_notes_general/>
                                    </_notes>
                                </annotations>
                                <documentation>
                                    <input/>
                                    <output/>
                                    <implementation>
                                        <description/>
                                    </implementation>
                                    <code>
                                        <description/>
                                    </code>
                                </documentation>
                            </call>
                            <call id="a6" endpoint="timeout">
                                <parameters>
                                    <label/>
                                    <method>:post</method>
                                    <arguments>
                                        <timeout>2</timeout>
                                    </arguments>
                                </parameters>
                                <annotations>
                                    <_generic/>
                                    <_timing>
                                        <_timing_weight/>
                                        <_timing_avg/>
                                        <explanations/>
                                    </_timing>
                                    <_shifting>
                                        <_shifting_type>Duration</_shifting_type>
                                    </_shifting>
                                    <_context_data_analysis>
                                        <probes/>
                                        <ips/>
                                    </_context_data_analysis>
                                    <report>
                                        <url/>
                                    </report>
                                    <_notes>
                                        <_notes_general/>
                                    </_notes>
                                </annotations>
                                <documentation>
                                    <input/>
                                    <output/>
                                    <implementation>
                                        <description/>
                                    </implementation>
                                </documentation>
                            </call>
                        </loop>
                        <call id="a3" endpoint="subprocess">
                            <parameters>
                                <label>Adjust Mixing Power</label>
                                <arguments>
                                    <behavior>wait_running</behavior>
                                    <url>https://raw.githubusercontent.com/ylkhayat/smart-socket-service/main/docs/testsets/start-wait-stop/start-wait-stop.xml</url>
                                    <init>
                                        <toggleDuration>!data.mixingTime</toggleDuration>
                                    </init>
                                    <endpoints/>
                                    <attributes/>
                                    <customization/>
                                </arguments>
                            </parameters>
                            <code>
                                <prepare/>
                                <finalize output="result"/>
                                <update output="result"/>
                                <rescue output="result"/>
                            </code>
                            <annotations>
                                <_generic/>
                                <_timing>
                                    <_timing_weight/>
                                    <_timing_avg/>
                                    <explanations/>
                                </_timing>
                                <_shifting>
                                    <_shifting_type>Duration</_shifting_type>
                                </_shifting>
                                <_context_data_analysis>
                                    <probes/>
                                    <ips/>
                                </_context_data_analysis>
                                <report>
                                    <url/>
                                </report>
                                <_notes>
                                    <_notes_general/>
                                </_notes>
                            </annotations>
                            <documentation>
                                <input/>
                                <output/>
                                <implementation>
                                    <description/>
                                </implementation>
                                <code>
                                    <description/>
                                </code>
                            </documentation>
                        </call>
                        <call id="a2" endpoint="send">
                            <parameters>
                                <label>Signal Mixer Done</label>
                                <arguments>
                                    <id>!data.idStop</id>
                                    <message/>
                                    <ttl>0</ttl>
                                </arguments>
                            </parameters>
                            <annotations>
                                <_generic/>
                                <_timing>
                                    <_timing_weight/>
                                    <_timing_avg/>
                                    <explanations/>
                                </_timing>
                                <_shifting>
                                    <_shifting_type>Duration</_shifting_type>
                                </_shifting>
                                <_context_data_analysis>
                                    <probes/>
                                    <ips/>
                                </_context_data_analysis>
                                <report>
                                    <url/>
                                </report>
                                <_notes>
                                    <_notes_general/>
                                </_notes>
                            </annotations>
                            <documentation>
                                <input/>
                                <output/>
                                <implementation>
                                    <description/>
                                </implementation>
                            </documentation>
                        </call>
                    </parallel_branch>
                    <parallel_branch pass="" local="">
                        <call id="a21" endpoint="globaltolocal">
                            <parameters>
                                <label>From Global to Local position</label>
                                <method>:put</method>
                                <arguments/>
                            </parameters>
                            <annotations>
                                <_generic/>
                                <_timing>
                                    <_timing_weight/>
                                    <_timing_avg/>
                                    <explanations/>
                                </_timing>
                                <_shifting>
                                    <_shifting_type>Duration</_shifting_type>
                                </_shifting>
                                <_context_data_analysis>
                                    <probes/>
                                    <ips/>
                                </_context_data_analysis>
                                <report>
                                    <url/>
                                </report>
                                <_notes>
                                    <_notes_general/>
                                </_notes>
                            </annotations>
                            <documentation>
                                <input/>
                                <output/>
                                <implementation>
                                    <description/>
                                </implementation>
                            </documentation>
                        </call>
                        <call id="a23" endpoint="localpickupmixer">
                            <parameters>
                                <label>From Local to Pickup to Mixer position</label>
                                <method>:put</method>
                                <arguments/>
                            </parameters>
                            <annotations>
                                <_generic/>
                                <_timing>
                                    <_timing_weight/>
                                    <_timing_avg/>
                                    <explanations/>
                                </_timing>
                                <_shifting>
                                    <_shifting_type>Duration</_shifting_type>
                                </_shifting>
                                <_context_data_analysis>
                                    <probes/>
                                    <ips/>
                                </_context_data_analysis>
                                <report>
                                    <url/>
                                </report>
                                <_notes>
                                    <_notes_general/>
                                </_notes>
                            </annotations>
                            <documentation>
                                <input/>
                                <output/>
                                <implementation>
                                    <description/>
                                </implementation>
                            </documentation>
                        </call>
                        <call id="a24" endpoint="send">
                            <parameters>
                                <label>Signal mixer to start</label>
                                <arguments>
                                    <id>!data.idStart</id>
                                    <message/>
                                    <ttl>0</ttl>
                                </arguments>
                            </parameters>
                            <code>
                                <prepare/>
                                <finalize output="result">data.mixerResponded = false</finalize>
                                <update output="result"/>
                                <rescue output="result"/>
                            </code>
                            <annotations>
                                <_generic/>
                                <_timing>
                                    <_timing_weight/>
                                    <_timing_avg/>
                                    <explanations/>
                                </_timing>
                                <_shifting>
                                    <_shifting_type>Duration</_shifting_type>
                                </_shifting>
                                <_context_data_analysis>
                                    <probes/>
                                    <ips/>
                                </_context_data_analysis>
                                <report>
                                    <url/>
                                </report>
                                <_notes>
                                    <_notes_general/>
                                </_notes>
                            </annotations>
                            <documentation>
                                <input>
                                    <item label="idStart">Id to communicate with the process to start the mixer</item>
                                </input>
                                <output/>
                                <implementation>
                                    <description/>
                                </implementation>
                                <code>
                                    <description/>
                                </code>
                            </documentation>
                        </call>
                        <loop mode="pre_test" condition="!data.mixerResponded">
                            <_probability>
                                <_probability_min/>
                                <_probability_max/>
                                <_probability_avg/>
                            </_probability>
                            <call id="a22" endpoint="receive">
                                <parameters>
                                    <label>Await signal from mixer </label>
                                    <arguments>
                                        <id>!data.idStop</id>
                                        <ttl>5</ttl>
                                        <delete>true</delete>
                                    </arguments>
                                </parameters>
                                <code>
                                    <prepare/>
                                    <finalize output="result">data.mixerResponded = true</finalize>
                                    <update output="result"/>
                                    <rescue output="result">data.mixerResponded = false</rescue>
                                </code>
                                <annotations>
                                    <_generic/>
                                    <_timing>
                                        <_timing_weight/>
                                        <_timing_avg/>
                                        <explanations/>
                                    </_timing>
                                    <_shifting>
                                        <_shifting_type>Duration</_shifting_type>
                                    </_shifting>
                                    <_context_data_analysis>
                                        <probes/>
                                        <ips/>
                                    </_context_data_analysis>
                                    <report>
                                        <url/>
                                    </report>
                                    <_notes>
                                        <_notes_general/>
                                    </_notes>
                                </annotations>
                                <documentation>
                                    <input/>
                                    <output/>
                                    <implementation>
                                        <description/>
                                    </implementation>
                                    <code>
                                        <description/>
                                    </code>
                                </documentation>
                            </call>
                            <call id="a27" endpoint="timeout">
                                <parameters>
                                    <label/>
                                    <method>:post</method>
                                    <arguments>
                                        <timeout>2</timeout>
                                    </arguments>
                                </parameters>
                                <annotations>
                                    <_generic/>
                                    <_timing>
                                        <_timing_weight/>
                                        <_timing_avg/>
                                        <explanations/>
                                    </_timing>
                                    <_shifting>
                                        <_shifting_type>Duration</_shifting_type>
                                    </_shifting>
                                    <_context_data_analysis>
                                        <probes/>
                                        <ips/>
                                    </_context_data_analysis>
                                    <report>
                                        <url/>
                                    </report>
                                    <_notes>
                                        <_notes_general/>
                                    </_notes>
                                </annotations>
                                <documentation>
                                    <input/>
                                    <output/>
                                    <implementation>
                                        <description/>
                                    </implementation>
                                </documentation>
                            </call>
                        </loop>
                        <call id="a26" endpoint="mixerpickuplocal">
                            <parameters>
                                <label>From Mixer to Pickup to Local position</label>
                                <method>:put</method>
                                <arguments/>
                            </parameters>
                            <annotations>
                                <_generic/>
                                <_timing>
                                    <_timing_weight/>
                                    <_timing_avg/>
                                    <explanations/>
                                </_timing>
                                <_shifting>
                                    <_shifting_type>Duration</_shifting_type>
                                </_shifting>
                                <_context_data_analysis>
                                    <probes/>
                                    <ips/>
                                </_context_data_analysis>
                                <report>
                                    <url/>
                                </report>
                                <_notes>
                                    <_notes_general/>
                                </_notes>
                            </annotations>
                            <documentation>
                                <input/>
                                <output/>
                                <implementation>
                                    <description/>
                                </implementation>
                            </documentation>
                        </call>
                        <call id="a28" endpoint="localtoglobal">
                            <parameters>
                                <label>From Local to Global position</label>
                                <method>:put</method>
                                <arguments/>
                            </parameters>
                            <annotations>
                                <_generic/>
                                <_timing>
                                    <_timing_weight/>
                                    <_timing_avg/>
                                    <explanations/>
                                </_timing>
                                <_shifting>
                                    <_shifting_type>Duration</_shifting_type>
                                </_shifting>
                                <_context_data_analysis>
                                    <probes/>
                                    <ips/>
                                </_context_data_analysis>
                                <report>
                                    <url/>
                                </report>
                                <_notes>
                                    <_notes_general/>
                                </_notes>
                            </annotations>
                            <documentation>
                                <input/>
                                <output/>
                                <implementation>
                                    <description/>
                                </implementation>
                            </documentation>
                        </call>
                    </parallel_branch>
                </parallel>
                <stop id="a4"/>
            </loop>
        </description>
    </description>
    <transformation>
        <description type="copy"/>
        <dataelements type="none"/>
        <endpoints type="none"/>
    </transformation>
</testset>